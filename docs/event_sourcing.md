### イベントソーシング

※販売者と購入者はauthとの同期処理が必要なのでイベントソーシングを行わない.

ペット情報と注文(とカート)の変更はイベントで保存するため, リプレイとスナップショットの機能がある.

以下の3スレッドが動作しており, 非同期にDBを更新する.

- WebServer
- コマンドモデル用メッセージキュープロセッサ
- クエリモデル用メッセージキュープロセッサ

### WebServer スレッド:
1. ユースケース: 集約のコマンドメソッドから得たドメインイベントをコマンドモデル用Publisherに渡す
2. コマンドモデル用Publisher: コマンドモデル用メッセージキューにドメインイベントをenqueueする

### コマンドモデル用メッセージキュープロセッサ スレッド:
1. プロセッサ: メッセージキューからドメインイベントをdequeueしてSubscriberに渡す
2. Subscriber: ドメインイベント毎にコマンドモデル用DBに書き込む
    1. N回毎にスナップショットを作成する
3. プロセッサ: ドメインイベントをクエリモデル用Publisherに渡す
4. クエリモデル用Publisher: クエリモデル用メッセージキューにドメインイベントをenqueueする

### クエリモデル用メッセージキュープロセッサ スレッド:
1. プロセッサ: メッセージキューからドメインイベントをdequeueしてSubscriberに渡す
2. Subscriber: ドメインイベント毎にクエリモデル用DBに書き込む
